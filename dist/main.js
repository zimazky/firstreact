(()=>{"use strict";function e({firmware:e="",controllerDateTime:t=""}){const[a,l]=React.useState(Date.now());React.useEffect((()=>{const e=setInterval((()=>{l(Date.now())}),1e3);return()=>{clearInterval(e)}}),[]);const i=new Date(a),s=i.toLocaleTimeString(),n=i.toLocaleDateString();return React.createElement("div",{className:"header_c8adb03"},React.createElement("div",{className:"left_cdef396"},React.createElement("div",{className:"title_f84cf26"},"Arduino TermoController"),React.createElement("div",null,e),React.createElement("div",null,t)),React.createElement("div",{className:"datetime_fdfbec6"},React.createElement("div",{className:"time_b1c1c45"},s),React.createElement("div",{className:"date_d7127cf"},n)))}function t(){return t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},t.apply(this,arguments)}function a({active:e=!1,disabled:a=!1,children:l="Button",...i}){return React.createElement("div",t({className:"button_c0afaa2 "+(e?"active_b40adfc":"")},i),l)}function l({title:e="Modal title",isOpen:t=!1,onSubmit:a=(()=>{}),onCancel:l=(()=>{}),children:i=null}){return t&&React.createElement("div",{className:"modalOverlay_faa7164",onClick:l},React.createElement("div",{className:"modalWindow_fac41c2",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"modalHeader_ec3e5fe"},React.createElement("div",{className:"modalTitle_e276bb7"},e)),React.createElement("div",{className:"modalBody_a8134eb"},i),React.createElement("div",{className:"modalFooter_dcf803f"},React.createElement("span",{className:"cancel_b0d96c0",onClick:l},"Cancel"),React.createElement("span",{className:"apply_dc7f5d7",onClick:a},"Apply"))))}const i="name_fc64aab",s="value_be14f95",n="modal_button_aad8592";function r({parameterName:e,displayedValue:t=0,controlledValue:a=0,disabled:r=!1,update:c=(e=>{})}){const[o,h]=React.useState(!1),[u,d]=React.useState(a);return console.log("ModalState:",o),console.log("ParameterState:",u),r?React.createElement("span",{className:"disabled_acbb102"},React.createElement("div",{className:i},e),React.createElement("div",{className:s},t)):React.createElement("span",{className:"enabled_fe9b8d8",onClick:()=>{h(!o)}},React.createElement("div",{className:i},e),React.createElement("div",{className:s},t),React.createElement(l,{isOpen:o,title:"Set target temperature for Zone",onSubmit:()=>{c(u),h(!1)},onCancel:()=>{h(!1)}},React.createElement("span",{className:n,onClick:()=>{d(u-.1)}},"-"),React.createElement("span",{className:"modal_parameter_be59a01"},u.toFixed(1)),React.createElement("span",{className:n,onClick:()=>{d(u+.1)}},"+")))}const c={controlbox:"controlbox_d0c639d",header:"header_b26ca6e"};function o({zone:e,update:t}){return console.log(e),React.createElement("div",{className:c.controlbox},React.createElement("div",{className:c.header},React.createElement("div",{className:c.indicator}),"ZONE"+e.id),React.createElement("div",null,React.createElement(a,{onClick:()=>{console.log("pwrcontrol_button")}},"PWRCTRL"),React.createElement(a,{disabled:!0},"PWR"),React.createElement(a,null,"CONFIG")),React.createElement("div",null,React.createElement(a,{onClick:()=>{console.log("showpwr_button")}},"SHOWPWR")),React.createElement("div",null,React.createElement(r,{parameterName:"temperature",displayedValue:e.temperature.toFixed(1)+"°("+e.targetTemperature.toFixed(1)+"±"+e.targetTemperatureDelta+")",controlledValue:e.targetTemperature,update:a=>{t({...e,targetTemperature:a})}}),React.createElement(r,{parameterName:"humidity",displayedValue:e.humidity.toFixed(1)+"%",disabled:!0})),React.createElement("div",{className:"sensorstatus"}))}class h{constructor(e,t="stepped"){this.time=e,this.zmode=t,this.data=[],this.flag=0,this.value=0,this.high=Number.MIN_VALUE,this.low=Number.MAX_VALUE,this.open=0,this.close=0,this.topen=0,this.tclose=0,this.nclose=0,this.tstep=0,this.zdata=[]}push(e){if(!(e.time<this.time)){if(0==this.data.length)return this.flag=1,this.value=this.low=this.high=this.open=this.close=e.value,this.topen=this.tclose=e.time,void this.data.push({flag:0,time:e.time,value:e.value});this.tclose>this.topen&&(this.value=(this.value*(this.tclose-this.topen)+(this.close-this.open)*(e.time-this.tclose))/(e.time-this.topen)),this.close!=e.value||1!=e.flag?(this.low=Math.min(this.low,e.value),this.high=Math.max(this.high,e.value),this.close=e.value,this.tclose=e.time,this.nclose=0,this.data.push({flag:e.flag,time:e.time,value:e.value})):0==this.nclose?(this.nclose++,this.tclose=e.time,this.data.push({flag:e.flag,time:e.time,value:e.value})):(this.data[this.data.length-1].time=e.time,this.tclose=e.time)}}getlinearregdata(e){for(var t=[],a=this.data[0],l=this.time,i=a.value;l+e<a.time;)t.push({flag:0,value:i}),l+=e;t.push({flag:1,value:i});for(var s=1;s<this.data.length;s++){a=this.data[s];var n=t.length-1,r=this.data[s-1];if(a.time<l+e)t[n].value+=(a.value-i)*(l+e-a.time)/e,i=a.value;else{l+=e;var c=(a.value-r.value)/(a.time-r.time);for(i=r.value+c*(l-r.time);l+e<a.time;){var o=i+c*e;t.push({flag:a.flag,value:(i+o)/2}),i=o,l+=e}t.push({flag:1,value:i})}}return t}getsteppedregdata(e){for(var t=[],a=this.data[0],l=this.time,i=a.value;l+e<a.time;)t.push({flag:0,value:i}),l+=e;t.push({flag:1,value:i});for(var s=1;s<this.data.length;s++){a=this.data[s];var n=t.length-1,r=this.data[s-1];if(a.time<l+e)t[n].value+=(a.value-i)*(l+e-a.time)/e,i=a.value;else{for(l+=e,i=r.value;l+e<a.time;)t.push({flag:a.flag,value:i}),l+=e;0==a.flag&&(i=a.value),t.push({flag:1,value:i})}}return t.push({flag:1,value:i}),t}getohlcregdata(e){for(var t=[],a=this.data[0],l=this.time,i=a.value;l+e<a.time;)t.push({flag:0,open:i,high:i,low:i,close:i}),l+=e;t.push({flag:1,open:i,high:i,low:i,close:i});for(var s=1;s<this.data.length;s++){a=this.data[s];var n=t.length-1,r=this.data[s-1];if(a.time<l+e)t[n].close=a.value,t[n].high=a.value>t[n].high?a.value:t[n].high,t[n].low=a.value<t[n].low?a.value:t[n].low;else{for(l+=e,i=r.value;l+e<a.time;)t.push({flag:a.flag,open:i,high:i,low:i,close:i}),l+=e;0==a.flag&&(i=a.value),t.push({flag:1,open:i,high:i,low:i,close:i})}}return t.push({flag:1,open:i,high:i,low:i,close:i}),t}gethighlowregdata(e){for(var t=[],a=this.data[0],l=this.time,i=a.value;l+e<a.time;)t.push({flag:0,high:i,low:i}),l+=e;t.push({flag:1,high:i,low:i});for(var s=1;s<this.data.length;s++){a=this.data[s];var n=t.length-1,r=this.data[s-1];if(a.time<l+e)t[n].high=a.value>t[n].high?a.value:t[n].high,t[n].low=a.value<t[n].low?a.value:t[n].low;else{for(l+=e,i=r.value;l+e<a.time;)t.push({flag:a.flag,high:i,low:i}),l+=e;0==a.flag&&(i=a.value),t.push({flag:1,high:i,low:i})}}return t.push({flag:1,high:i,low:i}),t}rezoom(e){e<1&&(e=1),this.tstep!=e&&0!=this.data.length&&(this.tstep=e,"linear"==this.zmode?this.zdata=this.getlinearregdata(e):"stepped"==this.zmode?this.zdata=this.getsteppedregdata(e):"highlow"==this.zmode?this.zdata=this.gethighlowregdata(e):"ohlc"==this.zmode&&(this.zdata=this.getohlcregdata(e)))}fillzdata(e,t,a){if(this.tclose<=e.begin||this.topen>=e.end)return a;this.rezoom(t);var l=e.begin,i=~~((e.begin-this.time)/t),s=0;i<0&&(l=this.time,s=-i,i=0);var n=a.min,r=a.max;if("linear"==this.zmode||"stepped"==this.zmode)for(;l<e.end&&l<this.tclose;i++,s++,l+=t){var c=this.zdata[i].flag;a.zdata[s].flag=c;var o=this.zdata[i].value;a.zdata[s].value=o,1==c&&(n=o<n?o:n,r=o>r?o:r)}else if("highlow"==this.zmode)for(;l<e.end&&l<this.tclose;i++,s++,l+=t){c=this.zdata[i].flag,a.zdata[s].flag=c;var h=this.zdata[i].high,u=this.zdata[i].low;a.zdata[s].high=h,a.zdata[s].low=u,1==c&&(n=u<n?u:n,r=h>r?h:r)}else if("ohlc"==this.zmode)for(;l<e.end&&l<this.tclose;i++,s++,l+=t){c=this.zdata[i].flag,a.zdata[s].flag=c;var d=this.zdata[i].open,m=(h=this.zdata[i].high,u=this.zdata[i].low,this.zdata[i].close);a.zdata[s].open=d,a.zdata[s].high=h,a.zdata[s].low=u,a.zdata[s].close=m,1==c&&(n=u<n?u:n,r=h>r?h:r)}return{zdata:a.zdata,min:n,max:r}}integrate(e){var t=0;if(this.data.length>0)for(var a=this.data[0],l=1;l<this.data.length;l++){var i=this.data[l];i.time>e.begin&&i.time<=e.end&&(t+=a.value*(i.time-a.time),a=i)}return t}clearzdata(){this.zdata=[],this.tstep=0}}function u(e,t,a=window,l={}){const i=function(e){const t=React.useRef(e);return React.useLayoutEffect((()=>{t.current=e})),t.current}(t);React.useEffect((()=>{if(!a?.addEventListener)return;console.log("AddEventListener",e);const t=e=>i(e);return a.addEventListener(e,t,l),()=>{console.log("RemoveEventListener",e),a.removeEventListener(e,t,l)}}),[e,a])}let d=!1,m=0,f=0,g=null;const v={gridBox:"gridBox_fc13aaa",context:"context_f11840f",detail:"detail_ec20b03",contextTickLabels:"contextTickLabels_fe07fb7",detailTickLabels:"detailTickLabels_f68035d",svgBox:"svgBox_b08058f",yLabels:"yLabels_e4cb634",yTickLabels:"yTickLabels_c40706f"};function p({data:e,height:t,barw:a=2,min:l,max:i,color:s="#FFF"}){let n=t/(i-l),r="";e[0].flag&&(r+="M0 "+(t-n*(e[0].value-l)));for(let i=1;i<e.length;i++)if(e[i].flag){let s=t-n*(e[i].value-l);e[i-1].flag?r+="L"+i*a+" "+s:r+="M"+i*a+" "+s}return React.createElement("path",{d:r,fill:"none",stroke:s,strokeWidth:"1"})}const b=[{value:1,unit:"s",shift:10800},{value:2,unit:"s",shift:10800},{value:5,unit:"s",shift:10800},{value:10,unit:"s",shift:10800},{value:20,unit:"s",shift:10800},{value:30,unit:"s",shift:10800},{value:60,unit:"m",shift:10800},{value:120,unit:"m",shift:10800},{value:300,unit:"m",shift:10800},{value:600,unit:"m",shift:10800},{value:1200,unit:"m",shift:10800},{value:1800,unit:"m",shift:10800},{value:3600,unit:"h",shift:10800},{value:7200,unit:"h",shift:10800},{value:10800,unit:"h",shift:10800},{value:21600,unit:"h",shift:10800},{value:43200,unit:"h",shift:10800},{value:86400,unit:"d",shift:10800},{value:172800,unit:"d",shift:10800},{value:345600,unit:"d",shift:10800},{value:604800,unit:"w",shift:27e4},{value:1209600,unit:"w",shift:27e4},{value:2629800,unit:"M",shift:1},{value:5259600,unit:"M",shift:2},{value:7889400,unit:"M",shift:3},{value:15778800,unit:"M",shift:6}],w=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];function R({title:e="TimeDiagram",width:t=300,height:a=200,min:l=0,max:i=1,children:s=null,timeInterval:n,onShift:r=(()=>{}),onZoom:c=(()=>{}),onSelectDate:o=(()=>{})}){const[h,p]=React.useState({x:0,y:0}),R=React.useRef(null);!function(e,t,a=(()=>{}),l=(()=>{}),i=(()=>{})){const s=function(e,t=200){let a,l,i=!1;return function s(){if(i)return a=arguments,void(l=this);e.apply(this,arguments),i=!0,setTimeout((()=>{i=!1,a&&(s.apply(l,a),a=l=null)}),t)}}((e=>{if(e.preventDefault(),d){if(e.isPrimary){let l=(e.offsetX-m)/t;return m=e.offsetX,a(l),void i(e.offsetX,e.offsetY)}if(g===e.pointerId){let a=e.offsetX-m;if(Math.abs(a)<10)return;if(a=(f-m)/a,a<0)return;let i=m/t;f=e.offsetX,l(a,i)}}else i(e.offsetX,e.offsetY)}),30);u("wheel",(function(e){e.preventDefault();let a=e.wheelDelta>0?.9:1.1111111111111112,i=e.offsetX/t;l(a,i)}),e),u("pointerdown",(function(e){if(e.preventDefault(),e.isPrimary)return d=!0,void(m=e.offsetX);null===g&&(g=e.pointerId,f=e.offsetX)}),e),u("pointermove",s,e),u("pointerup",(function(e){e.preventDefault(),e.isPrimary?d=!1:g===e.pointerId&&(g=null,f=0)}),e),u("pointerout",(function(e){i(0,0)}),e)}(R.current,t,r,c,((e,t)=>{p({x:e,y:t})}));let E=(i-l)/a;return React.createElement(React.Fragment,null,React.createElement("div",{className:v.header,style:{width:t}},React.createElement("div",null,e)),React.createElement("div",{className:v.gridBox},React.createElement("div",{className:v.context}," ",function(e,t,a,l=50){let i=l*(t-e)/a,[s]=[0,...b.filter((e=>i>=e.value)).keys()].slice(-1),n=a/(t-e);const r=[];let c=new Date(1e3*(e+10800)),o=e;if("M"==b[s].unit){do{let e=c.getUTCFullYear();c.setUTCHours(0),c.setMinutes(0),c.setSeconds(0),c.setUTCFullYear(e+1,0,1);let a=c.getTime()/1e3-10800,l=a<t?(a-o)*n:(t-o)*n;r.push({tick:o,label:e,width:l}),o=a}while(o<t);return r}if("d"==b[s].unit||"w"==b[s].unit){do{let e=c.getUTCMonth()+1,a=c.getUTCFullYear();c.setUTCHours(0),c.setMinutes(0),c.setSeconds(0),c.setUTCDate(1),c.setUTCMonth(e);let l=c.getTime()/1e3-10800,i=l<t?(l-o)*n:(t-o)*n;r.push({tick:o,label:a+"."+(e<10?"0":"")+e,width:i}),o=l}while(o<t);return r}if("h"==b[s].unit){let a=86400*~~((e+b[s].shift)/86400+1)-b[s].shift;do{let e=a<t?(a-o)*n:(t-o)*n,l=new Date(1e3*(o+10800)),i=l.getUTCDate(),s=l.getUTCMonth()+1,c=l.getUTCFullYear();r.push({tick:o,label:c+"."+(s<10?"0":"")+s+"."+(i<10?"0":"")+i,width:e}),o=a,a+=86400}while(o<t);return r}if("m"==b[s].unit){let a=3600*~~((e+b[s].shift)/3600+1)-b[s].shift;do{let e=a<t?(a-o)*n:(t-o)*n,l=new Date(1e3*(o+10800)),i=l.getUTCHours(),s=l.getUTCDate(),c=l.getUTCMonth()+1;r.push({tick:o,label:(c<10?"0":"")+c+"."+(s<10?"0":"")+s+" "+(i<10?"0":"")+i+"h",width:e}),o=a,a+=3600}while(o<t);return r}if("s"==b[s].unit){let a=60*~~((e+b[s].shift)/60+1)-b[s].shift;do{let e=a<t?(a-o)*n:(t-o)*n,l=new Date(1e3*(o+10800)),i=l.getUTCMinutes(),s=l.getUTCHours();r.push({tick:o,label:(s<10?"0":"")+s+":"+(i<10?"0":"")+i,width:e}),o=a,a+=60}while(o<t);return r}return r}(n.begin,n.end,t,50).map((e=>React.createElement("div",{className:v.contextTickLabels,key:e.tick,style:{width:e.width}},e.label)))),React.createElement("div",{className:v.detail,style:{height:a+12}}," ",function(e,t,a,l=50){let i=l*(t-e)/a,[s]=[0,...b.filter((e=>i>=e.value)).keys()].slice(-1),n=a/(t-e),r=e,c=new Date(1e3*(e+10800));const o=[];if("M"==b[s].unit){do{let e=c.getUTCMonth();c.getUTCFullYear(),c.setUTCHours(0),c.setMinutes(0),c.setSeconds(0),c.setUTCDate(1),c.setUTCMonth(e+(b[s].shift-e%b[s].shift));let a=c.getTime()/1e3-10800,l=a<t?(a-r)*n:(t-r)*n;o.push({tick:r,label:w[e],width:l}),r=a}while(r<t);return o}let h=b[s].value,u=~~((e+b[s].shift)/h+1)*h-b[s].shift;if("s"==b[s].unit){do{let e=u<t?(u-r)*n:(t-r)*n;c=new Date(1e3*(r+10800));let a=c.getUTCSeconds();o.push({tick:r,label:(a<10?"0":"")+a+"''",width:e}),r=u,u+=h}while(r<t);return o}if("m"==b[s].unit){do{let e=u<t?(u-r)*n:(t-r)*n;c=new Date(1e3*(r+10800));let a=c.getUTCMinutes();o.push({tick:r,label:(a<10?"0":"")+a+"'",width:e}),r=u,u+=h}while(r<t);return o}if("h"==b[s].unit){do{let e=u<t?(u-r)*n:(t-r)*n;c=new Date(1e3*(r+10800));let a=c.getUTCHours();o.push({tick:r,label:(a<10?"0":"")+a+"h",width:e}),r=u,u+=h}while(r<t);return o}if("d"==b[s].unit){do{let e=u<t?(u-r)*n:(t-r)*n;c=new Date(1e3*(r+10800));let a=c.getUTCDate();o.push({tick:r,label:(a<10?"0":"")+a,width:e}),r=u,u+=h}while(r<t);return o}if("w"==b[s].unit){do{let e=u<t?(u-r)*n:(t-r)*n;c=new Date(1e3*(r+10800));let a=c.getUTCDate();o.push({tick:r,label:(a<10?"0":"")+a,width:e}),r=u,u+=h}while(r<t);return o}return o}(n.begin,n.end,t,50).map((e=>React.createElement("div",{className:v.detailTickLabels,key:e.tick,style:{width:e.width,height:a+12},onClick:()=>{o(e.tick)}},e.label)))),React.createElement("div",{className:v.yLabels,style:{width:t,height:a}}," ",function(e,t,a,l=20){let i=l*(t-e)/a,s=Math.round(Math.log(i)/Math.log(10)),n=Math.pow(10,s),r=i/n;r<=1?r=1:r<=2?r=2:r<=5?r=5:(r=10,s++),s=s<0?-s:0;let c=n*r,o=a/(t-e),h=[],u=t,d=c*~~(t/c);do{let t=d>e?o*(u-d):o*(u-e);t>0&&h.push({tick:u,label:u.toFixed(s),height:t}),u=d,d-=c}while(u>e);return h}(l,i,a).map(((e,t)=>React.createElement("div",{className:v.yTickLabels,key:t,style:{height:e.height}},e.label)))),React.createElement("svg",{ref:R,width:t,height:a,viewBox:`0 0 ${t} ${a}`,className:v.svgBox},s)),React.createElement("div",{style:{width:t}},new Date(1e3*(n.begin+h.x*(n.end-n.begin)/t)).toLocaleString()+" "+(i-E*h.y).toFixed(2)))}const E="row_f8cec4a",y={width:35},N={width:60},T={width:30};function z({title:e="Table",headerName:t="value",data:a=[],time:l,height:i=200}){const[s,n]=React.useState(a.findIndex((e=>e.time>=l))),r=React.useRef(null),c=React.useRef(l);if(c.current!=l){c.current=l;let e=a.findIndex((e=>e.time>=l));console.log(e,s),n(e),console.log(c.current)}let o=~~(i/12),h=a.length,u=i*(o/h);u=u<5?5:u;let d=s/h*(i-u);function m(e){e.preventDefault();let t=e.wheelDelta>0?-5:5;n((e=>e+t))}const f=React.useRef({isDragging:!1,y:0,row:s});function g(e){if(f.current.isDragging){let t=h*(e.clientY-f.current.y)/i,a=f.current.row+t;a<0&&(a=0),a>h-o&&(a=h-o),n(~~a)}}function v(e){f.current={isDragging:!1,y:0}}return React.useEffect((()=>(console.log("TimeTable AddEventListener Mouse"),r.current.addEventListener("wheel",m),document.addEventListener("mousemove",g),document.addEventListener("mouseup",v),()=>{console.log("TimeRemoveEventListener Mouse"),r.current.removeEventListener("wheel",m),document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",v)})),[]),React.createElement(React.Fragment,null,React.createElement("div",null,e),React.createElement("div",{ref:r,className:"wrapper_b8d6404",style:{height:i}},React.createElement("div",{className:"table_a2395b7"},React.createElement("div",{className:E},React.createElement("span",{style:y},"#"),React.createElement("span",{style:N},"time"),React.createElement("span",{style:T},t))," ",a.slice(s,s+o).map(((e,t)=>{let a=(e.time+10800)%86400,l=~~(a/3600),i=~~(a%3600/60),n=a%60;return React.createElement("div",{className:E,key:t},React.createElement("span",{style:y},s+t+1),React.createElement("span",{style:N},(l<10?"0":"")+l+":"+(i<10?"0":"")+i+":"+(n<10?"0":"")+n),React.createElement("span",{style:T},e.value))}))),React.createElement("div",{className:"scrollbarTrack_e15be30",onClick:function(e){n((e=>e+o>h?h:e+o))}},React.createElement("div",{className:"scrollbarUp_a9a56e8",style:{height:d},onClick:function(e){e.stopPropagation(),n((e=>e-o<0?0:e-o))}}),React.createElement("div",{className:"scrollbarThumb_dbe7646",style:{height:u},onMouseDown:function(e){e.preventDefault(),f.current={isDragging:!0,y:e.clientY,row:s},console.log("mouseDown",e)},onClick:e=>{e.stopPropagation()}}))))}class x{constructor(e,t){this.url=e,this.ext=t,this.array=[],this.tryes=[],this.parse=function(e,t){return{time:e,status:0}},this.onload=function(){},this.ondock=function(e,t){}}load(e,t="text"){if(!x.loading&&void 0===this.array[e]){var a=86400*~~((Date.now()/1e3+10800)/86400)-10800;if(!(e>a)){x.loading=!0;var l=new Date(1e3*(e+10800)),i=l.getUTCDate(),s=l.getUTCMonth()+1,n=l.getUTCFullYear(),r=this.url+n+(s<10?"0":"")+s+(i<10?"0":"")+i+"."+this.ext,c=new XMLHttpRequest;c.responseType=t,c.open("GET",r,!0),c.onreadystatechange=function(t){4==c.readyState&&(200==c.status?(this.array[e]=this.parse(e,c.response),delete this.tryes[e],void 0!==this.array[e+86400]&&0!=this.array[e+86400].flag&&this.ondock(this.array[e],this.array[e+86400]),void 0!==this.array[e-86400]&&0!=this.array[e-86400].flag&&this.ondock(this.array[e-86400],this.array[e])):0!=c.status?(console.log("loading error",c.statusText),console.log("status",c.status),this.array[e]={flag:0}):(void 0===this.tryes[e]?this.tryes[e]=1:this.tryes[e]+=1,console.log("trying",this.tryes[e]),this.tryes[e]>3&&(this.array[e]={flag:0},delete this.tryes[e])),x.loading=!1,this.onload())}.bind(this),c.send(null),console.log(r)}}}preparezdata(e,t){for(var a=Number.MAX_VALUE,l=Number.MIN_VALUE,i=[],s=e.begin;s<e.end;s+=t)i.push({flag:0});return{zdata:i,min:a,max:l}}getzdata(e,t){for(var a=this.preparezdata(e,t),l=86400*~~((e.begin+10800)/86400)-10800;l<e.end;l+=86400)void 0===this.array[l]?this.load(l,"text"):0!=this.array[l].flag&&(a=this.array[l].fillzdata(e,t,a));return a}}x.loading=!1;class _ extends x{constructor(e,t,a,l,i){super(e,"Z"+t),this.tcolor=a,this.hcolor=l,this.pcolor=i,this.showpower=!1,this.parse=function(e,t){var a=new h(e),l=new h(e),i=new h(e);if(t){for(var s=t.split("\n"),n=0,r=(e=0,0),c=0,o=0,u=0,d=0,m=0,f=0;f<s.length;f++){var g=s[f].split(";");if(!(g.length<2))if(128&g[0]){e=0,r=0,c=0,o=0,d=0,n=parseInt(g[1]);var v=2;1&g[0]&&(e=parseFloat(g[v++])),2&g[0]&&(r=parseFloat(g[v++])),u=4&g[0]?100:0,i.push({flag:1,time:n,value:u}),16&g[0]&&(c=parseFloat(g[v++])),32&g[0]&&(o=parseFloat(g[v++])),64&g[0]&&(d=parseFloat(g[v++])),0==d&&(a.push({flag:0,time:n,value:e/10}),l.push({flag:0,time:n,value:r/10}))}else{if(0==n)continue;var p=parseInt(g[1]);(p=p>2147483647?p-4294967296:p)<0&&console.log(p,n,e,r,c,o,d),n+=p,v=2,1&g[0]&&(e+=parseFloat(g[v++])),2&g[0]&&(r+=parseFloat(g[v++])),4&g[0]?100!=u&&(u=100,i.push({flag:1,time:n,value:u})):0!=u&&(u=0,i.push({flag:1,time:n,value:u})),16&g[0]&&(c+=parseFloat(g[v++])),32&g[0]&&(o+=parseFloat(g[v++])),64&g[0]&&(d=parseFloat(g[v++])),m=0==d?1:0,0==d&&(1&g[0]&&a.push({flag:m,time:n,value:e/10}),2&g[0]&&l.push({flag:m,time:n,value:r/10}))}}0!=a.data.length&&a.push({flag:m,time:n,value:e/10}),0!=l.data.length&&l.push({flag:m,time:n,value:r/10}),0!=i.data.length&&i.push({flag:1,time:n,value:u})}return{t:a,h:l,p:i}}}preparezdata(e,t){for(var a={zdata:[],min:Number.MAX_VALUE,max:Number.MIN_VALUE},l={zdata:[],min:Number.MAX_VALUE,max:Number.MIN_VALUE},i={zdata:[],min:Number.MAX_VALUE,max:Number.MIN_VALUE},s=e.begin;s<e.end;s+=t)a.zdata.push({flag:0}),l.zdata.push({flag:0}),i.zdata.push({flag:0});return{t:a,h:l,p:i}}getzdata(e,t){for(var a=this.preparezdata(e,t),l=86400*~~((e.begin+10800)/86400)-10800;l<e.end;l+=86400)void 0===this.array[l]?this.load(l,"text"):0!=this.array[l].flag&&(a.t=this.array[l].t.fillzdata(e,t,a.t),a.h=this.array[l].h.fillzdata(e,t,a.h),a.p=this.array[l].p.fillzdata(e,t,a.p));return a}}let D=[],k={};k.end=new Date("2021.12.25 00:00:00")/1e3,k.begin=k.end-172800;const C=250;function M(){const[e,t]=React.useState(k),[a,l]=React.useState([]),[i,s]=React.useState(0);React.useEffect((()=>{D.push(new _("./log/",2,"white","white","red")),D.push(new _("./log/",3,"white","white","red")),D.forEach((e=>{e.onload=()=>{t((e=>({...e})))}}))}),[]),React.useEffect((()=>{let t=1*(e.end-e.begin)/350,a=D.map((a=>a.getzdata(e,t)));l(a)}),[e]);const n=React.useCallback((e=>{t((t=>{let a=t.end-t.begin;return{begin:t.begin-a*e,end:t.end-a*e}}))})),r=React.useCallback(((e,a)=>{t((t=>{let l=t.end-t.begin;if(e*l<300)return t;let i=t.begin+a*l;return{begin:i-e*(i-t.begin),end:i+e*(t.end-i)}}))})),c=React.useCallback((e=>{s(e)}));let o=Math.min(...a.map((e=>e.t.min))),h=Math.max(...a.map((e=>e.t.max))),u=Math.min(...a.map((e=>e.h.min))),d=Math.max(...a.map((e=>e.h.max))),m=86400*~~((i+10800)/86400)-10800;return React.createElement("div",{className:"wrapper_d20fbe7"},React.createElement("div",{className:"diagramsColumn_ebe3634"},React.createElement(R,{title:"Temperature, °C",timeInterval:e,onShift:n,onZoom:r,onSelectDate:c,min:o,max:h,width:350,height:C},a[0]&&React.createElement(p,{data:a[0].t.zdata,height:C,min:o,max:h,barw:1,color:"#ffa23c"}),a[1]&&React.createElement(p,{data:a[1].t.zdata,height:C,min:o,max:h,barw:1,color:"#88a23c"})),React.createElement(R,{title:"Humidity, %",timeInterval:e,onShift:n,onZoom:r,onSelectDate:c,min:u,max:d,width:350,height:C},a[0]&&React.createElement(p,{data:a[0].h.zdata,height:C,min:u,max:d,barw:1,color:"#bbb"}),a[1]&&React.createElement(p,{data:a[1].h.zdata,height:C,min:u,max:d,barw:1,color:"#88bbbb"}))),0!=i&&React.createElement("div",{className:"tableColumn_b6b5e3d"},React.createElement(z,{title:new Date(1e3*i).toLocaleDateString()+" Z2 H",data:D[0].array[m].h?D[0].array[m].h.data:[],time:i}),React.createElement(z,{title:new Date(1e3*i).toLocaleDateString()+" Z3 H",data:D[1].array[m].h?D[1].array[m].h.data:[],time:i})))}class L{constructor(e){this.url=e}getInfo(){return fetch(this.url+"/?g:i&r="+Math.random())}static parseInfo(e){const t=e.split(";"),[a,l,i,s,n,r,c,o,...h]=t;return{version:a,numofz:+l,unixtime:+i,starttime:+s,lastsynctime:+n,lastsyncdelta:+r,lastsyncinterval:+c,tickcounter:+o,zones:function e(t,a=[]){const[l,i,s,n,r,c,o,...h]=t;return a.push({t:+l,tc:+i,h:+s,m:+n,p:+r,dt:+c,s:+o}),h.length&&e(h,a),a}(h)}}}function U(){const[t,a]=React.useState([{id:"1",temperature:21.5,targetTemperature:25,targetTemperatureDelta:.2,humidity:56},{id:"2",temperature:22.4,targetTemperature:23.4,targetTemperatureDelta:.1,humidity:55.6},{id:"3",temperature:13.5,targetTemperature:0,targetTemperatureDelta:0,humidity:98.2}]),[l,i]=React.useState({version:"offline",unixtime:0});return React.useEffect((()=>{const e=new L("http://192.168.2.2");e.getInfo().then((e=>e.text())).then((e=>{i(L.parseInfo(e))})).catch((()=>{}));const t=setInterval((()=>{e.getInfo().then((e=>e.text())).then((e=>{i(L.parseInfo(e))})).catch((()=>{}))}),1e4);return clearInterval(t)}),[]),React.createElement("div",{className:"wrapper_d808929"},React.createElement(e,{firmware:l.version,controllerDateTime:new Date(1e3*l.unixtime).toLocaleTimeString()}),React.createElement("div",{className:"main_ef0bc9e"},React.createElement("div",{className:"controlsbox_d8af8a5"},t.map(((e,l)=>React.createElement(o,{key:l,zone:e,update:e=>{a(t.map((t=>(console.log(e),t.id==e.id?e:t))))}})))),React.createElement("div",{className:"diagramsbox_e0be825"},React.createElement(M,null)),React.createElement("div",{className:"info_bae79b0"},JSON.stringify(l))))}ReactDOM.render(React.createElement(U,null),document.getElementById("root"))})();