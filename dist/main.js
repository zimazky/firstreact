(()=>{"use strict";var e={95:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HydroEventParser=t.HydroDataSet=void 0;const s=i(a(818));class r{constructor(e){this.pressure=new s.default(e),this.mode=new s.default(e)}push(e,t){void 0!==e.pressure&&this.pressure.push({flag:e.flag,value:e.pressure,time:t}),void 0!==e.mode&&this.mode.push({flag:1,value:e.mode,time:t})}}t.HydroDataSet=r,t.HydroEventParser=class{constructor(){this.pdata=0,this.pressure=0,this.mode=0,this.hiLimit=0,this.loLimit=0,this.dryLimit=0,this.pumpInitTime=0,this.pumpRunLimit=0,this.retryInterval=0}parseEventOld(e){const t={},a=+e[0];let i=2;128&a&&(this.pdata=0),1&a&&(this.pdata+=+e[i++]),4&a&&(t.mode=this.mode=+e[i++]),8&a&&(t.hiLimit=this.hiLimit=+e[i++],t.loLimit=this.loLimit=+e[i++],t.dryLimit=this.dryLimit=+e[i++]),16&a&&(t.pumpInitTime=this.pumpInitTime=+e[i++],t.pumpRunLimit=this.pumpRunLimit=+e[i++],t.retryInterval=this.retryInterval=+e[i++]);let s=2&a?5*(this.pdata-102.3)/818.4:this.pdata/1e3;return s>=-1&&s<=6&&(t.flag=128&a?0:1,t.pressure=this.pressure=s),t}parseEvent(e,t){const a={},i=+e[1];let s=2;128&i&&(this.pdata=0),1&i&&(this.pdata+=+e[s++]),4&i&&(a.mode=this.mode=+e[s++]),8&i&&(a.hiLimit=this.hiLimit=+e[s++],a.loLimit=this.loLimit=+e[s++],a.dryLimit=this.dryLimit=+e[s++]),16&i&&(a.pumpInitTime=this.pumpInitTime=+e[s++],a.pumpRunLimit=this.pumpRunLimit=+e[s++],a.retryInterval=this.retryInterval=+e[s++]);let r=2&i?5*(this.pdata-102.3)/818.4:this.pdata/1e3;return r>=-1&&r<=5&&(a.flag=1,a.pressure=this.pressure=r),[e.slice(s),a]}getLastData(){return{flag:1,pressure:this.pressure,mode:this.mode,hiLimit:this.hiLimit,loLimit:this.loLimit,dryLimit:this.dryLimit,pumpInitTime:this.pumpInitTime,pumpRunLimit:this.pumpRunLimit,retryInterval:this.retryInterval}}createLogDataSet(e){return new r(e)}}},6:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HydroSensorData=void 0;const s=a(95),r=a(805),n=i(a(170)),o=i(a(818));t.HydroSensorData=class{constructor(e,t,a,i,s){this.id=e,this.ext="H"+e,this.logLoader=t.logLoader,this.color=a,this.timeslots=[],this.begin=i,this.end=s}createEventParser(){return new s.HydroEventParser}getDataSet(e){return void 0===this.timeslots[e]&&(this.timeslots[e]=new s.HydroDataSet(e)),this.timeslots[e]}createDataSet(e){return void 0!==this.timeslots[e]?null:(this.timeslots[e]=new s.HydroDataSet(e),this.timeslots[e])}getParser(e){return{name:this.ext,parser:this.createEventParser(),dataset:this.getDataSet(e)}}load(e){e<this.begin||e>this.end||void 0!==this.timeslots[e]||this.logLoader.getLogByTimestamp(this.ext,e,(t=>{this.parseHydroLogData(t,e)}),(()=>{void 0===this.timeslots[e]&&(this.timeslots[e]=null)}))}getRegData(e,t,a){const i=o.default.createzdata(e,t);for(let s=n.default.getBeginDayTimestamp(e.begin);s<e.end;s+=86400)void 0===this.timeslots[s]?a(s):null!==this.timeslots[s]&&this.timeslots[s].pressure.fillzdata(e,t,i);return i}parseHydroLogData(e,t){const a=e.split("\n"),i=new r.TickerEventParser,n=new s.HydroEventParser,o=this.createDataSet(t);null!==o&&e&&a.forEach((e=>{const t=e.split(";");if(t.length<=2)return;const a=i.parseEventOld(t);if(0==a)return;const s=n.parseEventOld(t);o.push(s,a)}))}}},408:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.LLogController=void 0;const i=a(805);t.LLogController=class{constructor(e,t,a){this.id=0,this.ext="L",this.load=e=>{e>=this.begin&&e<=this.end?this.logLoader.getLogByTimestamp(this.ext,e,(t=>{this.parseLogData(t,e)})):(this.thermoSensors.forEach((t=>t.load(e))),this.hydroSensors.forEach((t=>t.load(e))))},this.logLoader=e.logLoader,this.timeslots=[],this.begin=t,this.end=a,this.thermoSensors=e.thermoSensors,this.hydroSensors=e.hydroSensors}createEventParser(){return new i.TickerEventParser}getDataSet(e){return void 0===this.timeslots[e]&&(this.timeslots[e]=new i.TickerDataSet(e)),this.timeslots[e]}createDataSet(e){return void 0!==this.timeslots[e]?null:(this.timeslots[e]=new i.TickerDataSet(e),this.timeslots[e])}getParser(e){return{name:this.ext,parser:this.createEventParser(),dataset:this.getDataSet(e)}}parseLogData(e,t){const a=this.thermoSensors.map((e=>e.getParser(t))),s=this.hydroSensors.map((e=>e.getParser(t))),r={name:"T",parser:new i.TickerEventParser};if(!e)return;const n=e.split("\n");let o=!1;n.forEach((e=>{if(e.startsWith("F"))return void(o=!0);let t=e.split(";");const i=t.findIndex((e=>"T"===e));if(i<0)return;const[n,l]=r.parser.parseEvent(t.slice(i),o);for(t=t.slice(0,i);t.length>0;){const e=t[0],i=a.find((t=>t.name===e));if(void 0!==i){const[e,a]=i.parser.parseEvent(t,o);i.dataset.push(a,l.time),t=e;continue}const r=s.find((t=>t.name===e));if(void 0===r)t=t.slice(1);else{const[e,a]=r.parser.parseEvent(t,o);r.dataset.push(a,l.time),t=e}}o=!1}));const l=r.parser.getLastTime();a.forEach((e=>e.dataset.push(e.parser.getLastData(),l))),s.forEach((e=>e.dataset.push(e.parser.getLastData(),l)))}}},805:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TickerEventParser=t.TickerDataSet=void 0;const s=i(a(818));class r{constructor(e){this.loopcounter=new s.default(e)}push(e,t){void 0!==e.loopcounter&&this.loopcounter.push({flag:1,value:e.loopcounter,time:t})}}t.TickerDataSet=r,t.TickerEventParser=class{constructor(){this.time=0,this.loopcounter=0}parseEventOld(e){128&+e[0]&&(this.time=0);let t=+e[1];return t=t>2147483647?t-4294967296:t,t<0&&console.log(t,this.time),this.time+=t,this.time}parseEvent(e,t){t&&(this.time=0,this.loopcounter=0);let a=+e[1];return a=a>2147483647?a-4294967296:a,a<0&&console.log(a,this.time),this.time+=a,this.loopcounter+=+e[2],[e.slice(3),{time:this.time,loopcounter:this.loopcounter}]}getLastData(){return{time:this.time,loopcounter:this.loopcounter}}getLastTime(){return this.time}createLogDataSet(e){return new r(e)}}},100:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(a(170));var r;t.default=class{constructor(e,t=8){this.queue=[],this.inProcess=[],this.onload=()=>{},this.loadNext=()=>{const e=this.queue.shift();void 0!==e&&(this.inProcess.push(e.name),fetch(this.url+e.name).then((e=>{if(e.ok)return e.text();throw Error(`status=${e.status}`)})).then((t=>e.resolve(t))).catch((t=>{console.log(`loading error ${e.name}: ${t.message}`),e.reject()})).finally((()=>{this.inProcess=this.inProcess.filter((t=>t!=e.name)),this.onload(),this.loadNext()})))},this.threadsLimit=t,this.queue=[],this.url=e}getLogByTimestamp(e,t,a,i=(()=>{})){if(t>s.default.getBeginDayTimestamp(Date.now()/1e3))return r.NotYet;const n=s.default.YYYYMMDD(t)+"."+e;return this.getLogByName(n,a,i)}getLogByName(e,t,a){if(this.queue.some((t=>t.name==e))||this.inProcess.includes(e))return r.Queued;for(this.queue.push({name:e,resolve:t,reject:a});this.queue.length>0&&this.inProcess.length<this.threadsLimit;)this.loadNext();return r.OK}},function(e){e[e.OK=0]="OK",e[e.Busy=1]="Busy",e[e.Queued=2]="Queued",e[e.NotYet=3]="NotYet"}(r||(r={}))},913:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ThermoEventParser=t.ThermoDataSet=void 0;const s=i(a(818));class r{constructor(e){this.temperature=new s.default(e),this.humidity=new s.default(e),this.power=new s.default(e)}push(e,t){void 0!==e.temperature&&this.temperature.push({...e.temperature,time:t}),void 0!==e.humidity&&this.humidity.push({...e.humidity,time:t}),void 0!==e.power&&this.power.push({flag:1,value:e.power,time:t})}}t.ThermoDataSet=r,t.ThermoEventParser=class{constructor(){this.temperature=0,this.humidity=0,this.targetTemperature=0,this.targetTemperatureDelta=0,this.power=0,this.mode=0,this.sensorState=0,this.f=0}parseEventOld(e){let t={};const a=+e[0];let i=2;if(128&a&&(this.temperature=0,this.humidity=0,t.power=this.power=4&a?1:0,t.mode=this.mode=8&a?1:0,this.targetTemperature=0,this.targetTemperatureDelta=0,this.sensorState=0),1&a&&(this.temperature+=+e[i++]),2&a&&(this.humidity+=+e[i++]),4&a?this.power||(t.power=this.power=1):this.power&&(t.power=this.power=0),8&a?this.mode||(t.mode=this.mode=1):this.mode&&(t.mode=this.mode=0),16&a&&(t.targetTemperature=this.targetTemperature=+e[i++]),32&a&&(t.targetTemperatureDelta=this.targetTemperatureDelta=+e[i++]),64&a&&(t.sensorState=this.sensorState=+e[i++]),0==this.sensorState){const e=128&a?0:1;1&a&&(t.temperature={flag:e,value:this.temperature/10}),2&a&&(t.humidity={flag:e,value:this.humidity/10})}return t}parseEvent(e,t){let a={};const i=+e[1];let s=2;if(128&i&&(this.temperature=0,this.humidity=0,a.power=this.power=4&i?1:0,a.mode=this.mode=8&i?1:0,this.targetTemperature=0,this.targetTemperatureDelta=0,this.sensorState=0),1&i&&(this.temperature+=+e[s++]),2&i&&(this.humidity+=+e[s++]),4&i?this.power||(a.power=this.power=1):this.power&&(a.power=this.power=0),8&i?this.mode||(a.mode=this.mode=1):this.mode&&(a.mode=this.mode=0),16&i&&(a.targetTemperature=this.targetTemperature=+e[s++]),32&i&&(a.targetTemperatureDelta=this.targetTemperatureDelta=+e[s++]),64&i&&(a.sensorState=this.sensorState=+e[s++]),0==this.sensorState){const e=128&i?0:1;1&i&&(a.temperature={flag:e,value:this.temperature/10}),2&i&&(a.humidity={flag:e,value:this.humidity/10})}return[e.slice(s),a]}getLastData(){let e={};const t=0==this.sensorState?1:0;return e.temperature={flag:t,value:this.temperature/10},e.humidity={flag:t,value:this.humidity/10},e.power=this.power,e.mode=this.mode,e.targetTemperature=this.targetTemperature,e.targetTemperatureDelta=this.targetTemperatureDelta,e.sensorState=this.sensorState,e}createLogDataSet(e){return new r(e)}}},364:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ThermalSensorData=void 0;const s=a(805),r=a(913),n=i(a(170)),o=i(a(818));class l{constructor(e,t,[a,i,s],r,n){this.id=e,this.ext="Z"+e,this.logLoader=t.logLoader,this.colors={t:a,h:i,p:s},this.isShowPower=!1,this.timeslots=[],this.begin=r,this.end=n}createEventParser(){return new r.ThermoEventParser}getDataSet(e){return void 0===this.timeslots[e]&&(this.timeslots[e]=new r.ThermoDataSet(e)),this.timeslots[e]}createDataSet(e){return void 0!==this.timeslots[e]?null:(this.timeslots[e]=new r.ThermoDataSet(e),this.timeslots[e])}getParser(e){return{name:this.ext,parser:this.createEventParser(),dataset:this.getDataSet(e)}}load(e){e<this.begin||e>this.end||void 0!==this.timeslots[e]||this.logLoader.getLogByTimestamp(this.ext,e,(t=>{this.parseThermoLogData(t,e)}),(()=>{void 0===this.timeslots[e]&&(this.timeslots[e]=null)}))}getRegData(e,t,a){const i=l.DATASET_NAMES.map((()=>o.default.createzdata(e,t)));for(let s=n.default.getBeginDayTimestamp(e.begin);s<e.end;s+=86400)void 0===this.timeslots[s]?a(s):null!==this.timeslots[s]&&(this.timeslots[s].temperature.fillzdata(e,t,i[0]),this.timeslots[s].humidity.fillzdata(e,t,i[1]),this.timeslots[s].power.fillzdata(e,t,i[2]));return i}parseThermoLogData(e,t){const a=e.split("\n"),i=new s.TickerEventParser,n=new r.ThermoEventParser,o=this.createDataSet(t);if(null===o)return;if(!e)return;a.forEach((e=>{const t=e.split(";");if(t.length<=2)return;const a=i.parseEventOld(t);if(0===a)return;const s=n.parseEventOld(t);o.push(s,a)}));const l=n.getLastData(),h=i.getLastTime();o.push(l,h)}}t.ThermalSensorData=l,l.DATASET_NAMES=["Temperature","Humidity","Power"]},89:(e,t)=>{class a{constructor(e){this.url=e}getInfo(e=(e=>{}),t=(e=>{})){return fetch(this.url+"/?g:i&r="+Math.random()).then((e=>e.text())).then((t=>e(t))).catch((e=>{console.log("ArduinoController not available"),t(e)}))}setTemperature(e,t,a=(()=>{}),i=(()=>{})){return fetch(this.url+"/?s"+e+"t:"+Math.round(10*t)+"&r="+Math.random()).then((()=>{console.log("ArduinoController set temperature"),a()})).catch((()=>{console.log("ArduinoController set temperature failure"),i()}))}powerOn(e,t=(()=>{}),a=(()=>{})){return fetch(this.url+"/?s"+e+"m:1&r="+Math.random()).then((()=>{console.log("Power On",e),t()})).catch((()=>{console.log("Power On failure"),a()}))}powerOff(e,t=(()=>{}),a=(()=>{})){return fetch(this.url+"/?s"+e+"m:0&r="+Math.random()).then((()=>{console.log("Power Off",e),t()})).catch((()=>{console.log("Power Off failure"),a()}))}static parseInfo(e){const t=e.split(";"),[a,i,s,r,n,o,l,h,c,...u]=t;return{version:"ver."+a,numofz:+i,unixtime:+s,starttime:+r,lastsynctime:+n,lastsyncdelta:+o,lastsyncinterval:+l,tickcounter:+h,loopcounter:+c,zones:function e(t,a=[],i=0){if(!t.length)return a;const[s,...r]=t;switch(s){case"Z":{const[t,i,n,o,l,h,c,u,...m]=r;return a.push({type:s,id:+t,temperature:+i/10,targetTemperature:+n/10,humidity:+o/10,onControl:+l,powerOn:+h,targetTemperatureDelta:+c/10,sensorState:+u}),e(m,a,+t)}case"H":{const[t,i,n,o,l,h,c,u,m,...d]=r;return a.push({type:s,id:+t,pressure:5*(10*+i-1023)/8184,mode:+n,hilimit:+o,lolimit:+l,drylimit:+h,pumpinittime:+c,pumprunlimit:+u,retryinterval:+m}),e(d,a,+t)}case"I":{const[t,i,n,o,l,h,...c]=r,[u,m,d]=[+n,+o,+l],p=[255&u,u>>8&255,u>>16&255,u>>24&255],g=[255&m,m>>8&255,m>>16&255,m>>24&255],f=[255&d,d>>8&255,d>>16&255,d>>24&255];return a.push({type:s,id:+t,poweron:+i,start:p,duration:g,days:f,mduration:+h}),e(c,a,+t)}}return a}(u)}}}t.Z=a,a.states=["OK","ErrChecksum","ErrTimeout","ErrConnect","ErrAckL","ErrAckH","ErrUnknown"],a.sensorState=e=>a.states[-e]},941:function(e,t,a){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(a(100)),r=a(6),n=a(364),o=a(408);t.default=class{constructor(e,t=(()=>{}),a=8){this.logLoader=new s.default(e,a),this.thermoSensors=[],this.hydroSensors=[],this.logLoader.onload=t,this.logController=new o.LLogController(this,+new Date("2022.11.06")/1e3,Date.now()/1e3)}setOnLoad(e){this.logLoader.onload=e}addThermalSensor(e,[t,a,i],s,r){this.thermoSensors.push(new n.ThermalSensorData(e,this,[t,a,i],s,r))}addHydroSensor(e,t,a,i){this.hydroSensors.push(new r.HydroSensorData(e,this,t,a,i))}getThermalSensorsRegData(e,t){return this.thermoSensors.map((a=>a.getRegData(e,t,this.logController.load)))}getHydroSensorsRegData(e,t){return this.hydroSensors.map((a=>a.getRegData(e,t,this.logController.load)))}}},818:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class a{constructor(e,t="stepped"){this.data=[],this.flag=0,this.value=0,this.high=-Number.MAX_VALUE,this.low=Number.MAX_VALUE,this.open=0,this.close=0,this.topen=0,this.tclose=0,this.nclose=0,this.tstep=0,this.zdata=[],this.ohlcdata=[],this.hldata=[],this.time=e,this.zmode=t}push(e){if(!(e.time<this.time)){if(0==this.data.length)return this.flag=1,this.value=this.low=this.high=this.open=this.close=e.value,this.topen=this.tclose=e.time,void this.data.push({flag:0,time:e.time,value:e.value});this.tclose>this.topen&&(this.value=(this.value*(this.tclose-this.topen)+this.close*(e.time-this.tclose))/(e.time-this.topen)),this.close!=e.value||1!=e.flag?(this.low=Math.min(this.low,e.value),this.high=Math.max(this.high,e.value),this.close=e.value,this.tclose=e.time,this.nclose=0,this.data.push({flag:e.flag,time:e.time,value:e.value})):0==this.nclose?(this.nclose++,this.tclose=e.time,this.data.push({flag:e.flag,time:e.time,value:e.value})):(this.data[this.data.length-1].time=e.time,this.tclose=e.time)}}getlinearregdata(e){const t=[];let a=this.data[0],i=this.time,s=a.value;for(;i+e<a.time;)t.push({flag:0,value:s}),i+=e;t.push({flag:1,value:s});for(let r=1;r<this.data.length;r++){a=this.data[r];const n=t.length-1,o=this.data[r-1];if(a.time<i+e)t[n].value+=(a.value-s)*(i+e-a.time)/e,s=a.value;else{i+=e;const r=(a.value-o.value)/(a.time-o.time);for(s=o.value+r*(i-o.time);i+e<a.time;){const n=s+r*e;t.push({flag:a.flag,value:(s+n)/2}),s=n,i+=e}t.push({flag:1,value:s})}}return t}getsteppedregdata(e){const t=[];let a=this.data[0],i=this.time,s=a.value;for(;i+e<a.time;)t.push({flag:0,value:s}),i+=e;t.push({flag:1,value:s});for(let r=1;r<this.data.length;r++){a=this.data[r];const n=t.length-1,o=this.data[r-1];if(a.time<i+e)t[n].value+=(a.value-s)*(i+e-a.time)/e,s=a.value;else{for(i+=e,s=o.value;i+e<a.time;)t.push({flag:a.flag,value:s}),i+=e;0==a.flag&&(s=a.value),t.push({flag:1,value:s})}}return t.push({flag:1,value:s}),t}getohlcregdata(e){const t=[];let a=this.data[0],i=this.time,s=a.value;for(;i+e<a.time;)t.push({flag:0,open:s,high:s,low:s,close:s}),i+=e;t.push({flag:1,open:s,high:s,low:s,close:s});for(let r=1;r<this.data.length;r++){a=this.data[r];const n=t.length-1,o=this.data[r-1];if(a.time<i+e)t[n].close=a.value,t[n].high=a.value>t[n].high?a.value:t[n].high,t[n].low=a.value<t[n].low?a.value:t[n].low;else{for(i+=e,s=o.value;i+e<a.time;)t.push({flag:a.flag,open:s,high:s,low:s,close:s}),i+=e;0==a.flag&&(s=a.value),t.push({flag:1,open:s,high:s,low:s,close:s})}}return t.push({flag:1,open:s,high:s,low:s,close:s}),t}gethighlowregdata(e){const t=[];let a=this.data[0],i=this.time,s=a.value;for(;i+e<a.time;)t.push({flag:0,high:s,low:s}),i+=e;t.push({flag:1,high:s,low:s});for(var r=1;r<this.data.length;r++){a=this.data[r];const n=t.length-1,o=this.data[r-1];if(a.time<i+e)t[n].high=a.value>t[n].high?a.value:t[n].high,t[n].low=a.value<t[n].low?a.value:t[n].low;else{for(i+=e,s=o.value;i+e<a.time;)t.push({flag:a.flag,high:s,low:s}),i+=e;0==a.flag&&(s=a.value),t.push({flag:1,high:s,low:s})}}return t.push({flag:1,high:s,low:s}),t}rezoom(e){if(e<a.mintstep&&(e=a.mintstep),this.tstep!=e&&0!=this.data.length)switch(this.tstep=e,this.zmode){case"linear":this.zdata=this.getlinearregdata(e);break;case"stepped":this.zdata=this.getsteppedregdata(e);break;case"highlow":this.hldata=this.gethighlowregdata(e);break;case"ohlc":this.ohlcdata=this.getohlcregdata(e)}}static createzdata(e,t){const i={zdata:[],min:Number.MAX_VALUE,max:-Number.MAX_VALUE};t<a.mintstep&&(t=a.mintstep);for(let a=e.begin;a<e.end;a+=t)i.zdata.push({flag:0,value:0});return i}fillzdata(e,t,i){if(t<a.mintstep&&(t=a.mintstep),this.tclose<=e.begin||this.topen>=e.end)return i;this.rezoom(t);let s=e.begin,r=~~((e.begin-this.time)/t),n=0;for(r<0&&(s=this.time,n=-r,r=0);s<e.end&&s<this.tclose;r++,n++,s+=t){const e=this.zdata[r].flag;i.zdata[n].flag=e;const t=this.zdata[r].value;i.zdata[n].value=t,1==e&&(i.min=t<i.min?t:i.min,i.max=t>i.max?t:i.max)}return i}fillHLData(e,t,i){if(t<a.mintstep&&(t=a.mintstep),this.tclose<=e.begin||this.topen>=e.end)return i;this.rezoom(t);let s=e.begin,r=~~((e.begin-this.time)/t),n=0;for(r<0&&(s=this.time,n=-r,r=0);s<e.end&&s<this.tclose;r++,n++,s+=t){const e=this.hldata[r].flag;i.zdata[n].flag=e;const t=this.hldata[r].high,a=this.hldata[r].low;i.zdata[n].high=t,i.zdata[n].low=a,1==e&&(i.min=a<i.min?a:i.min,i.max=t>i.max?t:i.max)}return i}fillOHLCData(e,t,i){if(t<a.mintstep&&(t=a.mintstep),this.tclose<=e.begin||this.topen>=e.end)return i;this.rezoom(t);let s=e.begin,r=~~((e.begin-this.time)/t),n=0;for(r<0&&(s=this.time,n=-r,r=0);s<e.end&&s<this.tclose;r++,n++,s+=t){const e=this.ohlcdata[r].flag,t=this.ohlcdata[r].open,a=this.ohlcdata[r].high,s=this.ohlcdata[r].low,o=this.ohlcdata[r].close;i.zdata[n]={flag:e,open:t,high:a,low:s,close:o},1==e&&(i.min=s<i.min?s:i.min,i.max=a>i.max?a:i.max)}return i}integrate(e){let t=0;if(0==this.data.length)return t;let a=this.data[0];for(let i=1;i<this.data.length;i++){const s=this.data[i];s.time>e.begin&&s.time<=e.end&&(t+=a.value*(s.time-a.time),a=s)}return t}clearzdata(){this.zdata=[],this.hldata=[],this.ohlcdata=[],this.tstep=0}}t.default=a,a.mintstep=1},170:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class a{static initLocale(e=3,t=1){a.timezone=e,a.startWeek=t%7}static getUTCYearMonthDay(e){const t=Math.floor(e/86400),a=Math.floor((400*t+200)/146097);let i=1970+a;const s=i-2e3-1;let r=t-Math.floor((1461*a+1)/4);r+=Math.floor(s/100)-Math.floor(s/400);const n=(i%4||!(i%100))&&i%400?0:1;r>58+n&&(r+=2-n);let o=Math.floor((12*r+6)/367);const l=r-Math.floor((367*o+5)/12);return o<0&&(i--,o+=12),o>11&&(i++,o-=12),{year:i,month:o,day:l+1}}static getYearMonthDay(e){return a.getUTCYearMonthDay(e+3600*a.timezone)}static YYYYMMDDToTimestampUTC(e){let[t,a,i]=e.split(".",3);void 0===a&&([t,a,i]=e.split("-",3));const s=+t,r=+a-1,n=(s%4||!(s%100))&&s%400?0:1;let o=Math.floor((367*r+5)/12)+ +i-1;o>59+n&&(o-=2-n);const l=s-1970,h=s-2e3-1;let c=Math.floor((1461*l+1)/4);return c-=Math.floor(h/100)-Math.floor(h/400),c+=o,isNaN(c)?(console.log(`Ошибка преобразования строки '${e}' формата 'YYYY.MM.DD' к unixtime`),0):86400*c}static YYYYMMDDToTimestamp(e){return a.YYYYMMDDToTimestampUTC(e)-3600*a.timezone}static getWeekday(e){const t=(4+Math.floor((e+3600*a.timezone)/86400))%7;return e<0?0==t?0:t+7:t}static getDayMonthWeekday(e){const{month:t,day:i}=a.getYearMonthDay(e);return{day:i,month:t,weekday:a.getWeekday(e)}}static getBegintWeekTimestamp(e){const t=a.getBeginDayTimestamp(e);let i=a.getWeekday(e)-a.startWeek;return i<0&&(i+=7),t-86400*i}static getUTCBeginDayTimestamp(e){return 86400*Math.floor(e/86400)}static getBeginDayTimestamp(e){return 86400*Math.floor((e+3600*a.timezone)/86400)-3600*a.timezone}static getEndDayTimestamp(e){return a.getBeginDayTimestamp(e)+86399}static getUTCTime(e){return e<0?e%86400+86400:e%86400}static getTime(e){return a.getUTCTime(e+3600*a.timezone)}static getTimeToEndDay(e){return a.getEndDayTimestamp(e)-e}static getDifferenceInDays(e,t){return Math.floor((t-a.getBeginDayTimestamp(e))/86400)}static getUTCYYYYMMDD(e){const{year:t,month:i,day:s}=a.getUTCYearMonthDay(e),r=i+1;return t+(r>9?".":".0")+r+(s>9?".":".0")+s}static getYYYYMMDD(e){const{year:t,month:i,day:s}=a.getYearMonthDay(e),r=i+1;return t+(r>9?".":".0")+r+(s>9?".":".0")+s}static UTCYYYYMMDD(e){const{year:t,month:i,day:s}=a.getUTCYearMonthDay(e),r=i+1;return t+(r>9?"":"0")+r+(s>9?"":"0")+s}static YYYYMMDD(e){const{year:t,month:i,day:s}=a.getYearMonthDay(e),r=i+1;return t+(r>9?"":"0")+r+(s>9?"":"0")+s}static getUTCHoursMinutes(e){const t=a.getUTCTime(e);return{hours:Math.floor(t/3600),minutes:Math.floor(t%3600/60)}}static getHoursMinutes(e){const t=a.getTime(e);return{hours:Math.floor(t/3600),minutes:Math.floor(t%3600/60)}}static getUTCHHMM(e){const{hours:t,minutes:i}=a.getUTCHoursMinutes(e);return(t>9?"":"0")+t+(i>9?":":":0")+i}static getHHMM(e){const{hours:t,minutes:i}=a.getHoursMinutes(e);return(t>9?"":"0")+t+(i>9?":":":0")+i}static getUTCYYYYMMDDTHHMM(e){const{year:t,month:i,day:s}=a.getUTCYearMonthDay(e),{hours:r,minutes:n}=a.getUTCHoursMinutes(e),o=i+1;return t+(o>9?"-":"-0")+o+(s>9?"-":"-0")+s+(r>9?"T":"T0")+r+(n>9?":":":0")+n}static getYYYYMMDDTHHMM(e){const{year:t,month:i,day:s}=a.getYearMonthDay(e),{hours:r,minutes:n}=a.getHoursMinutes(e),o=i+1;return t+(o>9?"-":"-0")+o+(s>9?"-":"-0")+s+(r>9?"T":"T0")+r+(n>9?":":":0")+n}static secondsToHMM(e){const t=~~(e/3600),a=Math.abs(~~(e%3600/60));return t+(a>9?":":":0")+a}static HMMToSeconds(e){if(!e)return 0;const[t,a]=e.split(":",2),i=3600*+t,s=60*+a,r=i<0?i-s:i+s;return isNaN(r)||s<0?(console.log(`Ошибка преобразования строки '${e}' формата 'H:MM' к интервалу времени`),0):r}static secondsToDdHMM(e){const t=~~(e/86400),i=e%86400;return t>=1||t<=-1?t+"d "+a.secondsToHMM(Math.abs(i)):a.secondsToHMM(i)}static DdHMMToSeconds(e){const[t,i]=e.split("d",2);return void 0===i?a.HMMToSeconds(t):86400*+t+a.HMMToSeconds(i)}static isSameDay(e,t){return a.getBeginDayTimestamp(e)===a.getBeginDayTimestamp(t)}static isToday(e){return a.isSameDay(e,Date.now()/1e3)}}t.default=a,a.WEEKDAYS=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],a.MONTHS=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],a.MONTHS_FULL=["January","February","March","April","May","June","July","August","September","October","November","December"],a.startWeek=1,a.timezone=3,a.dateDelimiter="."}},t={};function a(i){var s=t[i];if(void 0!==s)return s.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,a),r.exports}a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=a(89),t=a(941),i=a.n(t);function s({firmware:e="",controllerDateTime:t=""}){const[a,i]=React.useState(Date.now());React.useEffect((()=>{const e=setInterval((()=>{i(Date.now())}),1e3);return()=>{clearInterval(e)}}),[]);const s=new Date(a),r=s.toLocaleTimeString(),n=s.toLocaleDateString();return React.createElement("div",{className:"header_c8adb03"},React.createElement("div",{className:"left_cdef396"},React.createElement("div",{className:"title_f84cf26"},"Arduino TermoController"),React.createElement("div",null,e),React.createElement("div",null,t)),React.createElement("div",{className:"datetime_fdfbec6"},React.createElement("div",{className:"time_b1c1c45"},r),React.createElement("div",{className:"date_d7127cf"},n)))}function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},r.apply(this,arguments)}function n({active:e=!1,disabled:t=!1,children:a="Button",...i}){return React.createElement("div",r({className:"button_c0afaa2 "+(e?"active_b40adfc":"")},i),a)}function o({title:e="Modal title",isOpen:t=!1,onSubmit:a=(()=>{}),onCancel:i=(()=>{}),children:s=null}){return t&&React.createElement("div",{className:"modalOverlay_faa7164",onClick:i},React.createElement("div",{className:"modalWindow_fac41c2",onClick:e=>e.stopPropagation()},React.createElement("div",{className:"modalHeader_ec3e5fe"},React.createElement("div",{className:"modalTitle_e276bb7"},e)),React.createElement("div",{className:"modalBody_a8134eb"},s),React.createElement("div",{className:"modalFooter_dcf803f"},React.createElement("span",{className:"cancel_b0d96c0",onClick:i},"Cancel"),React.createElement("span",{className:"apply_dc7f5d7",onClick:a},"Apply"))))}const l="name_fc64aab",h="value_be14f95",c="modal_button_aad8592",u=e=>Math.round(10*e)/10;function m({parameterName:e,displayedValue:t=0,controlledValue:a=0,controlledValue2:i=0,disabled:s=!1,update:r=(e=>{})}){const[n,m]=React.useState(!1),[d,p]=React.useState(a),[g,f]=React.useState(a),[v,y]=React.useState(!1);return s||React.useEffect((()=>{console.log("Effect update controlledValue",a),"number"==typeof a?(f(a),p(a)):p(g),y(!0)}),[a]),s?React.createElement("span",{className:"disabled_acbb102"},React.createElement("div",{className:l},e),React.createElement("div",{className:h},t)):React.createElement("span",{className:"enabled_fe9b8d8",onClick:()=>{m(!n)}},React.createElement("div",{className:l},e),React.createElement("div",null,React.createElement("span",{className:h},t),React.createElement("span",{className:v?h:"not_synced_value_afc6328"},"(",(v?g:d).toFixed(1),"±",i.toFixed(1),")")),React.createElement(o,{isOpen:n,title:"Set target temperature for Zone",onSubmit:()=>{d!=a&&(r(d),y(!1)),m(!1)},onCancel:()=>{p(a),m(!1)}},React.createElement("span",{className:c,onClick:()=>{p((e=>u(e-.1)))}},"-"),React.createElement("span",{className:"modal_parameter_be59a01",contentEditable:!0,suppressContentEditableWarning:!0,onBlur:e=>{console.log(+e.target.innerText),p(u(+e.target.innerText))}},d.toFixed(1)),React.createElement("span",{className:c,onClick:()=>{p((e=>u(e+.1)))}},"+")))}const d={controlbox:"controlbox_d0c639d",header:"header_b26ca6e"};function p({zone:t,onSetTemperature:a,onSetPowerControl:i}){return React.createElement("div",{className:d.controlbox},React.createElement("div",{className:d.header},React.createElement("div",{className:d.indicator}),"ZONE"+t.id+" Sensor: "+e.Z.sensorState(t.sensorState)),React.createElement("div",null,React.createElement(n,{active:!!t.onControl,onClick:()=>i(t.id)},"PWRCTRL"),React.createElement(n,{active:!!t.powerOn,disabled:!0},"PWR"),React.createElement(n,{onClick:()=>{console.log("showpwr_button")}},"SHOWPWR"),React.createElement(n,null,"CONFIG")),React.createElement("div",null,React.createElement(m,{parameterName:"temperature",displayedValue:t.temperature.toFixed(1)+"°",controlledValue:t.targetTemperature,controlledValue2:t.targetTemperatureDelta,update:e=>a({...t,targetTemperature:e})}),React.createElement(m,{parameterName:"humidity",displayedValue:t.humidity.toFixed(1)+"%",disabled:!0})),React.createElement("div",{className:"sensorstatus"}))}function g(e,t,a=window,i={}){const s=React.useRef(t).current;React.useEffect((()=>{if(!a?.addEventListener)return;console.log("AddEventListener",e);const t=e=>s(e);return a.addEventListener(e,t,i),()=>{console.log("RemoveEventListener",e),a.removeEventListener(e,t,i)}}),[e,a])}const f={gridBox:"gridBox_fc13aaa",context:"context_f11840f",detail:"detail_ec20b03",contextTickLabels:"contextTickLabels_fe07fb7",detailTickLabels:"detailTickLabels_f68035d",svgBox:"svgBox_b08058f",yLabels:"yLabels_e4cb634",yTickLabels:"yTickLabels_c40706f"};function v({data:e,height:t,barw:a=2,min:i,max:s,color:r="#FFF"}){let n=t/(s-i),o="";e[0].flag&&(o+="M0 "+(t-n*(e[0].value-i)));for(let s=1;s<e.length;s++)if(e[s].flag){let r=t-n*(e[s].value-i);e[s-1].flag?o+="L"+s*a+" "+r:o+="M"+s*a+" "+r}return React.createElement("path",{d:o,fill:"none",stroke:r,strokeWidth:"1"})}const y=[{value:1,unit:"s",shift:10800},{value:2,unit:"s",shift:10800},{value:5,unit:"s",shift:10800},{value:10,unit:"s",shift:10800},{value:20,unit:"s",shift:10800},{value:30,unit:"s",shift:10800},{value:60,unit:"m",shift:10800},{value:120,unit:"m",shift:10800},{value:300,unit:"m",shift:10800},{value:600,unit:"m",shift:10800},{value:1200,unit:"m",shift:10800},{value:1800,unit:"m",shift:10800},{value:3600,unit:"h",shift:10800},{value:7200,unit:"h",shift:10800},{value:10800,unit:"h",shift:10800},{value:21600,unit:"h",shift:10800},{value:43200,unit:"h",shift:10800},{value:86400,unit:"d",shift:10800},{value:172800,unit:"d",shift:10800},{value:345600,unit:"d",shift:10800},{value:604800,unit:"w",shift:27e4},{value:1209600,unit:"w",shift:27e4},{value:2629800,unit:"M",shift:1},{value:5259600,unit:"M",shift:2},{value:7889400,unit:"M",shift:3},{value:15778800,unit:"M",shift:6}],D=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];function w({title:e="TimeDiagram",width:t=300,height:a=200,min:i=0,max:s=1,children:r=null,timeInterval:n,onShift:o=(()=>{}),onZoom:l=(()=>{}),onSelectDate:h=(()=>{})}){const[c,u]=React.useState({x:0,y:0}),m=React.useRef(null);!function(e,t,a=(()=>{}),i=(()=>{}),s=(()=>{})){const r=React.useRef({isDragging:!1,clientX0:0,clientX1:0,pointerId1:null}).current,n=function(e,t=200){let a,i,s=!1;return function r(){if(s)return a=arguments,void(i=this);e.apply(this,arguments),s=!0,setTimeout((()=>{s=!1,a&&(r.apply(i,a),a=i=null)}),t)}}((e=>{if(e.preventDefault(),r.isDragging){if(e.isPrimary){let i=(e.offsetX-r.clientX0)/t;return r.clientX0=e.offsetX,a(i),void s(e.offsetX,e.offsetY)}if(r.pointerId1===e.pointerId){let a=e.offsetX-r.clientX0;if(Math.abs(a)<10)return;if(a=(r.clientX1-r.clientX0)/a,a<0)return;let s=r.clientX0/t;r.clientX1=e.offsetX,i(a,s)}}else s(e.offsetX,e.offsetY)}),30);g("wheel",(function(e){e.preventDefault();let a=e.wheelDelta>0?.9:1.1111111111111112,s=e.offsetX/t;i(a,s)}),e),g("pointerdown",(function(e){if(e.preventDefault(),e.isPrimary)return r.isDragging=!0,void(r.clientX0=e.offsetX);null===r.pointerId1&&(r.pointerId1=e.pointerId,r.clientX1=e.offsetX)}),e),g("pointermove",n,e),g("pointerup",(function(e){e.preventDefault(),e.isPrimary?r.isDragging=!1:r.pointerId1===e.pointerId&&(r.pointerId1=null,r.clientX1=0)}),e),g("pointerout",(function(e){s(0,0)}),e)}(m.current,t,o,l,((e,t)=>{u({x:e,y:t})}));let d=(s-i)/a;return React.createElement(React.Fragment,null,React.createElement("div",{className:f.header,style:{width:t}},React.createElement("div",null,e)),React.createElement("div",{className:f.gridBox},React.createElement("div",{className:f.context}," ",function(e,t,a,i=50){let s=i*(t-e)/a,[r]=[0,...y.filter((e=>s>=e.value)).keys()].slice(-1),n=a/(t-e);const o=[];let l=new Date(1e3*(e+10800)),h=e;if("M"==y[r].unit){do{let e=l.getUTCFullYear();l.setUTCHours(0),l.setMinutes(0),l.setSeconds(0),l.setUTCFullYear(e+1,0,1);let a=l.getTime()/1e3-10800,i=a<t?(a-h)*n:(t-h)*n;o.push({tick:h,label:e,width:i}),h=a}while(h<t);return o}if("d"==y[r].unit||"w"==y[r].unit){do{let e=l.getUTCMonth()+1,a=l.getUTCFullYear();l.setUTCHours(0),l.setMinutes(0),l.setSeconds(0),l.setUTCDate(1),l.setUTCMonth(e);let i=l.getTime()/1e3-10800,s=i<t?(i-h)*n:(t-h)*n;o.push({tick:h,label:a+"."+(e<10?"0":"")+e,width:s}),h=i}while(h<t);return o}if("h"==y[r].unit){let a=86400*~~((e+y[r].shift)/86400+1)-y[r].shift;do{let e=a<t?(a-h)*n:(t-h)*n,i=new Date(1e3*(h+10800)),s=i.getUTCDate(),r=i.getUTCMonth()+1,l=i.getUTCFullYear();o.push({tick:h,label:l+"."+(r<10?"0":"")+r+"."+(s<10?"0":"")+s,width:e}),h=a,a+=86400}while(h<t);return o}if("m"==y[r].unit){let a=3600*~~((e+y[r].shift)/3600+1)-y[r].shift;do{let e=a<t?(a-h)*n:(t-h)*n,i=new Date(1e3*(h+10800)),s=i.getUTCHours(),r=i.getUTCDate(),l=i.getUTCMonth()+1;o.push({tick:h,label:(l<10?"0":"")+l+"."+(r<10?"0":"")+r+" "+(s<10?"0":"")+s+"h",width:e}),h=a,a+=3600}while(h<t);return o}if("s"==y[r].unit){let a=60*~~((e+y[r].shift)/60+1)-y[r].shift;do{let e=a<t?(a-h)*n:(t-h)*n,i=new Date(1e3*(h+10800)),s=i.getUTCMinutes(),r=i.getUTCHours();o.push({tick:h,label:(r<10?"0":"")+r+":"+(s<10?"0":"")+s,width:e}),h=a,a+=60}while(h<t);return o}return o}(n.begin,n.end,t,50).map((e=>React.createElement("div",{className:f.contextTickLabels,key:e.tick,style:{width:e.width}},e.label)))),React.createElement("div",{className:f.detail,style:{height:a+12}}," ",function(e,t,a,i=50){let s=i*(t-e)/a,[r]=[0,...y.filter((e=>s>=e.value)).keys()].slice(-1),n=a/(t-e),o=e,l=new Date(1e3*(e+10800));const h=[];if("M"==y[r].unit){do{let e=l.getUTCMonth();l.getUTCFullYear(),l.setUTCHours(0),l.setMinutes(0),l.setSeconds(0),l.setUTCDate(1),l.setUTCMonth(e+(y[r].shift-e%y[r].shift));let a=l.getTime()/1e3-10800,i=a<t?(a-o)*n:(t-o)*n;h.push({tick:o,label:D[e],width:i}),o=a}while(o<t);return h}let c=y[r].value,u=~~((e+y[r].shift)/c+1)*c-y[r].shift;if("s"==y[r].unit){do{let e=u<t?(u-o)*n:(t-o)*n;l=new Date(1e3*(o+10800));let a=l.getUTCSeconds();h.push({tick:o,label:(a<10?"0":"")+a+"''",width:e}),o=u,u+=c}while(o<t);return h}if("m"==y[r].unit){do{let e=u<t?(u-o)*n:(t-o)*n;l=new Date(1e3*(o+10800));let a=l.getUTCMinutes();h.push({tick:o,label:(a<10?"0":"")+a+"'",width:e}),o=u,u+=c}while(o<t);return h}if("h"==y[r].unit){do{let e=u<t?(u-o)*n:(t-o)*n;l=new Date(1e3*(o+10800));let a=l.getUTCHours();h.push({tick:o,label:(a<10?"0":"")+a+"h",width:e}),o=u,u+=c}while(o<t);return h}if("d"==y[r].unit){do{let e=u<t?(u-o)*n:(t-o)*n;l=new Date(1e3*(o+10800));let a=l.getUTCDate();h.push({tick:o,label:(a<10?"0":"")+a,width:e}),o=u,u+=c}while(o<t);return h}if("w"==y[r].unit){do{let e=u<t?(u-o)*n:(t-o)*n;l=new Date(1e3*(o+10800));let a=l.getUTCDate();h.push({tick:o,label:(a<10?"0":"")+a,width:e}),o=u,u+=c}while(o<t);return h}return h}(n.begin,n.end,t,50).map((e=>React.createElement("div",{className:f.detailTickLabels,key:e.tick,style:{width:e.width,height:a+12},onClick:()=>{h(e.tick)}},e.label)))),React.createElement("div",{className:f.yLabels,style:{width:t,height:a}}," ",function(e,t,a,i=20){let s=i*(t-e)/a,r=Math.round(Math.log(s)/Math.log(10)),n=Math.pow(10,r),o=s/n;o<=1?o=1:o<=2?o=2:o<=5?o=5:(o=10,r++),r=r<0?-r:0;let l=n*o,h=a/(t-e),c=[],u=t,m=l*~~(t/l);do{let t=m>e?h*(u-m):h*(u-e);t>0&&c.push({tick:u,label:u.toFixed(r),height:t}),u=m,m-=l}while(u>e);return c}(i,s,a).map(((e,t)=>React.createElement("div",{className:f.yTickLabels,key:t,style:{height:e.height}},e.label)))),React.createElement("svg",{ref:m,width:t,height:a,viewBox:`0 0 ${t} ${a}`,className:f.svgBox},r)),React.createElement("div",{style:{width:t}},new Date(1e3*(n.begin+c.x*(n.end-n.begin)/t)).toLocaleString()+" "+(s-d*c.y).toFixed(2)))}const T="row_f8cec4a",b={width:35},E={width:60},M={width:30};function R({title:e="Table",headerName:t="value",data:a=[],time:i,height:s=200}){const[r,n]=React.useState(a.findIndex((e=>e.time>=i))),o=React.useRef(null),l=React.useRef(i);if(l.current!=i){l.current=i;let e=a.findIndex((e=>e.time>=i));console.log(e,r),n(e),console.log(l.current)}let h=~~(s/12),c=a.length,u=s*(h/c);u=u<5?5:u;let m=r/c*(s-u);const d=React.useRef({isDragging:!1,y:0,row:r});return g("wheel",(function(e){e.preventDefault();let t=e.wheelDelta>0?-5:5;n((e=>e+t))}),o.current),g("mousemove",(function(e){if(d.current.isDragging){let t=c*(e.clientY-d.current.y)/s,a=d.current.row+t;a<0&&(a=0),a>c-h&&(a=c-h),n(~~a)}}),o.current),g("mouseup",(function(e){d.current={isDragging:!1,y:0}}),o.current),React.createElement(React.Fragment,null,React.createElement("div",null,e),React.createElement("div",{ref:o,className:"wrapper_b8d6404",style:{height:s}},React.createElement("div",{className:"table_a2395b7"},React.createElement("div",{className:T},React.createElement("span",{style:b},"#"),React.createElement("span",{style:E},"time"),React.createElement("span",{style:M},t))," ",a.slice(r,r+h).map(((e,t)=>{let a=(e.time+10800)%86400,i=~~(a/3600),s=~~(a%3600/60),n=a%60;return React.createElement("div",{className:T,key:t},React.createElement("span",{style:b},r+t+1),React.createElement("span",{style:E},(i<10?"0":"")+i+":"+(s<10?"0":"")+s+":"+(n<10?"0":"")+n),React.createElement("span",{style:M},e.value))}))),React.createElement("div",{className:"scrollbarTrack_e15be30",onClick:function(e){n((e=>e+h>c?c:e+h))}},React.createElement("div",{className:"scrollbarUp_a9a56e8",style:{height:m},onClick:function(e){e.stopPropagation(),n((e=>e-h<0?0:e-h))}}),React.createElement("div",{className:"scrollbarThumb_dbe7646",style:{height:u},onMouseDown:function(e){e.preventDefault(),d.current={isDragging:!0,y:e.clientY,row:r},console.log("mouseDown",e)},onClick:e=>{e.stopPropagation()}}))))}const S=350,L=250;function _(e){const[t,a]=React.useState(e.timeInterval),[i,s]=React.useState({thermalData:[],hydroData:[]}),[r,n]=React.useState(0),l=React.useRef(e.logController).current;React.useEffect((()=>{a((t=>({begin:e.timeInterval.end-t.end+t.begin,end:e.timeInterval.end})))}),[e.timeInterval.end]),React.useEffect((()=>{l.setOnLoad((()=>a((e=>({...e}))))),l.addThermalSensor(2,["white","white","red"],new Date("2016.04.29")/1e3,new Date("2022.11.06")/1e3),l.addThermalSensor(3,["white","white","red"],new Date("2018.09.14")/1e3,new Date("2022.11.06")/1e3),l.addHydroSensor(0,["white","white","red"],new Date("2021.07.25")/1e3,new Date("2022.11.06")/1e3)}),[]),React.useEffect((()=>{let e=1*(t.end-t.begin)/S;const a=l.getThermalSensorsRegData(t,e),i=l.getHydroSensorsRegData(t,e);s({thermalData:a,hydroData:i})}),[t]);const h=React.useCallback((e=>{a((t=>{let a=t.end-t.begin;return{begin:t.begin-a*e,end:t.end-a*e}}))})),c=React.useCallback(((e,t)=>{a((a=>{let i=a.end-a.begin;if(e*i<300)return a;let s=a.begin+t*i;return{begin:s-e*(s-a.begin),end:s+e*(a.end-s)}}))})),u=React.useCallback((e=>{n(e)}));let m=Math.min(...i.thermalData.map((e=>e[0].min))),d=Math.max(...i.thermalData.map((e=>e[0].max))),p=Math.min(...i.thermalData.map((e=>e[1].min))),g=Math.max(...i.thermalData.map((e=>e[1].max))),f=Math.min(...i.hydroData.map((e=>e.min))),y=Math.max(...i.hydroData.map((e=>e.max))),D=86400*~~((r+10800)/86400)-10800;return React.createElement("div",{className:"wrapper_d20fbe7"},React.createElement("div",{className:"diagramsColumn_ebe3634"},React.createElement(w,{title:"Temperature, °C",timeInterval:t,onShift:h,onZoom:c,onSelectDate:u,min:m,max:d,width:S,height:L},i.thermalData[0]&&React.createElement(v,{data:i.thermalData[0][0].zdata,height:L,min:m,max:d,barw:1,color:"#ffa23c"}),i.thermalData[1]&&React.createElement(v,{data:i.thermalData[1][0].zdata,height:L,min:m,max:d,barw:1,color:"#88a23c"})),React.createElement(w,{title:"Humidity, %",timeInterval:t,onShift:h,onZoom:c,onSelectDate:u,min:p,max:g,width:S,height:L},i.thermalData[0]&&React.createElement(v,{data:i.thermalData[0][1].zdata,height:L,min:p,max:g,barw:1,color:"#bbb"}),i.thermalData[1]&&React.createElement(v,{data:i.thermalData[1][1].zdata,height:L,min:p,max:g,barw:1,color:"#88bbbb"})),React.createElement(w,{title:"Pressure Hydro System, bar",timeInterval:t,onShift:h,onZoom:c,onSelectDate:u,min:f,max:y,width:S,height:L},i.hydroData[0]&&React.createElement(v,{data:i.hydroData[0].zdata,height:L,min:f,max:y,barw:1,color:"#ffa23c"}))),0!=r&&React.createElement(o,{isOpen:0!=r,title:"Set target temperature for Zone",onCancel:()=>{n(0)}},React.createElement(R,{title:new Date(1e3*r).toLocaleDateString()+" Z2 H",data:l.hydroSensors[0].timeslots[D]?l.hydroSensors[0].timeslots[D].data:[],time:r})))}const C=[{type:"Z",id:1,temperature:14.1,targetTemperature:23.5,targetTemperatureDelta:.2,humidity:54.3,onControl:0,powerOn:0,sensorState:-3},{type:"Z",id:2,temperature:15.2,targetTemperature:21.2,targetTemperatureDelta:.1,humidity:48.1,onControl:0,powerOn:0,sensorState:-3},{type:"Z",id:3,temperature:5.9,targetTemperature:0,targetTemperatureDelta:0,humidity:85.1,onControl:0,powerOn:0,sensorState:-3},{type:"H",id:0,pressure:2.4}],x=window.location.hostname;console.log(x);const N="192.168.2.2"==x||"localhost"==x?"http://192.168.1.1:4480/data/log/":"./log/",k="192.168.2.2"==x?1:8,Y=new e.Z("http://192.168.2.2"),P=new(i())(N,(()=>{}),k),H="192.168.2.2"==x||"localhost"==x||"192.168.1.1"==x||"10.8.0.1"==x?Date.now()/1e3:new Date("2022.06.26 00:00:00")/1e3,z="192.168.2.2"==x||"localhost"==x||"192.168.1.1"==x||"10.8.0.1"==x;function O(){const[t,a]=React.useState({version:"offline",unixtime:0,zones:C}),[i,r]=React.useState({begin:H-172800,end:H});React.useEffect((()=>{if(z){const t=setInterval((()=>{r((e=>({...e,end:Date.now()/1e3})))}),12e5),i=setInterval((()=>{Y.getInfo((t=>a(e.Z.parseInfo(t))),(()=>a((e=>({...e,version:"offline"})))))}),1e4);return()=>{clearInterval(i),t&&clearInterval(t)}}}),[]);const n=React.useCallback((e=>{Y.setTemperature(e.id,e.targetTemperature,(()=>a((t=>({...t,zones:t.zones.map((t=>t.id==e.id?e:t))})))),(()=>a((t=>({...t,zones:t.zones.map((t=>t.id==e.id?{...t,targetTemperature:{}}:t))})))))})),o=React.useCallback((e=>{const i=e-1;t.zones[i].onControl?Y.powerOff(e,(()=>a((t=>({...t,zones:t.zones.map((t=>t.id==e?{...t,onControl:0}:t))}))))):Y.powerOn(e,(()=>a((t=>({...t,zones:t.zones.map((t=>t.id==e?{...t,onControl:1}:t))})))))}));return React.createElement("div",{className:"wrapper_d808929"},React.createElement(s,{firmware:t.version,controllerDateTime:new Date(1e3*t.unixtime).toLocaleTimeString()}),React.createElement("div",{className:"main_ef0bc9e"},React.createElement("div",{className:"controlsbox_d8af8a5"},t.zones.filter((e=>"Z"===e.type)).map(((e,t)=>React.createElement(p,{key:t,zone:e,onSetTemperature:n,onSetPowerControl:o})))),React.createElement("div",{className:"diagramsbox_e0be825"},React.createElement(_,{timeInterval:i,logController:P})),React.createElement("div",{className:"info_bae79b0"},JSON.stringify(t))))}ReactDOM.render(React.createElement(O,null),document.getElementById("root"))})()})();